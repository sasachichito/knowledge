# アーキテクチャ決定指針

サブドメインをアーキテクチャ量子で区分けし、それぞれで独自の系を構築する。

- アーキテクチャ量子
  - 同じアーキテクチャ特性を必要とするユースケースの集合、またそれを完遂するコードの集合（コンポーネント）

  
- 独自の系
  - 他の系のデータベースと物理的に切り離されている
  - 他の系とコードを共有しない
  - 他の系と同期通信しない
  - 他の系とリクエスト・リプライ方式の非同期通信をしない（ファイア・アンド・フォーゲット形式は可）
  - 他の系から独立してデプロイ可能
  - （補足）独自の系がデプロイ可能ユニットであることは必須ではない。系を構成するデプロイ可能コンポーネントは「境界付けられたコンテキスト」または「マイクロサービス」と呼ばれる。系内部は凝集度が高いため、系が複数のデプロイ可能コンポーネントで構成される場合は、それらでデータベース共有や同期通信は問題ない。


- サブドメインのサイジング指標
  - 適切
    - 当該サブドメインのドメインモデルに定義される概念を介して結合されていないユースケースの総和が最小となる（LCOMによる凝集度測定と同じ）。
    - ユビキタス言語の名前衝突がない
  - 過大
    - アーキテクチャ量子が大きくなり（同じアーキテクチャ量子を持つ無関係のユースケースが論理的にまとめて扱われてしまい）、それらが単一のデプロイ可能コンポーネントにまとめられる危険がある。そのようなコンポーネントは凝集度が低く全再利用の原則（CRP）に違反するため、理由と頻度の異なる変更が多発し不要なリリース調整とドメインモデルの複雑化を誘発する。
  - 過小
    - 当該サブドメインにユースケースが収まらない（他のサブドメインに強く依存する）ため、独自の系を構築できない。分散モノリスを誘発する。

